{% extends "layout_2_col.html" %}

{% load basket_tags %}
{% load promotion_tags %}
{% load category_tags1 %}
{% load product_tags %}
{% load i18n %}

{% block title %}
    {% if summary %}{{ summary }} |{% endif %} {{ block.super }}
{% endblock %}

{% block layout_extra_classnames %}grid--borderTopLess{% endblock %}
{% block layout_sidebar_extra_classnames %}u-desktop-only{% endblock %}

{% block grid_header_title %}
    <h1 class="title title--caps">{{ summary }}</h1>
{% endblock %}

{% block grid_header_nav %}
    <div>
        {# TODO : make it dynamic to actually sort items #}
        <form>
            <div class="select select--borderLess">
                <select>
                    <option value="" disabled selected="">Sort By</option>
                </select>
            </div>
        </form>
    </div>
    {% include "catalogue/partials/nb_of_results.html" %}
{% endblock %}

{% block column_left %}
    {% category_tree parent=category as tree_categories %}
    {% if tree_categories %}
        <div class="categories nested-lists">
            <ul class="nested-lists__list">
                {% for tree_category, info in tree_categories %}
                    <li class="nested-lists__item">
                        <a href="{{ tree_category.get_absolute_url }}">
                            {% if tree_category.pk == category.pk %}
                                <strong>{{ tree_category.name }}</strong>
                            {% else %}
                                {{ tree_category.name }}
                            {% endif %}
                        </a>

                        {% if info.has_children %}<ul class="nested-lists__list">{% else %}</li>{% endif %}
                        {% for n in info.num_to_close %}
                            </ul></li>
                        {% endfor %}
                {% endfor %}
            </ul>
        </div>
    {% endif %}
{% endblock %}

{% block content %}
    {% if products %}
        <ol class="grid__list">
            {% for product in products %}
                <li class="grid__item">{% render_product product %}</li>
            {% endfor %}
        </ol>
    {% else %}
        <p>{% trans "No products found." %}</p>
    {% endif %}
{% endblock content %}

{% block after_layout %}
    {% include "partials/pagination.html" %}
{% endblock %}

{% block onbodyload %}
    {{ block.super }}
    oscar.search.init();
{% endblock %}
