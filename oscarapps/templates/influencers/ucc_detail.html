{% extends "layout_2_col.html" %}
{% load i18n %}
{% load product_tags %}

{% block body_class %}creator{% endblock %}

{% block before_layout %}
    <div class="container container--pad creator__overviewContainer">
        <div class="cols cols--m-gutter32 creator__overviewCols">
            <div class="col creator__overviewCol creator__overviewCol--visual">
                <figure class="creator__overviewVisualCols">
                    <div class="creator__overviewVisualCol creator__overviewVisualCol--left">
                        <div class="img-container img-container--portrait">
                            {% if influencer.users.image %}
                                <img src="{{ influencer.users.image.url }}" alt="{{ influencer }}">
                            {% endif %}
                        </div>
                    </div>
                    <figcaption class="creator__overviewVisualCol creator__overviewVisualCol--info u-mobile-only">
                        <p class="title">{{ influencer.users.first_name }} {{ influencer.users.last_name }}</p>
                        <p class="creator__location">{{ influencer.location.city }},{{ influencer.location.state }},{{ influencer.location.country }}</p>
                    </figcaption>
                </figure>
            </div>
            <div class="col creator__overviewCol creator__overviewCol--info">
                <div class="creator__infoHeader u-desktop-only">
                    <h2 class="title">{{ influencer.users.first_name }} {{ influencer.users.last_name }}</h2>
                    <p class="creator__location">{{ influencer.location.city }},{{ influencer.location.state }},{{ influencer.location.country }}</p>
                </div>
                <div class="creator__infoContent">
                    <form class="creator__followForm">
                        {% if ucc_followed %}
                        <button class="cta cta--dark" id="follow_button" onclick="getFollowData('{{influencer.id}}')">
                            {% trans "Unfollow creator" %}</button> {# TODO - add "follow influencer" functionality #}
                        {% else %}
                            <button class="cta cta--dark" id="follow_button" onclick="getFollowData('{{influencer.id}}')">
                            {% trans "Follow creator" %}</button> {# TODO - add "follow influencer" functionality #}
                        {% endif %}
                    </form>
                    <p class="creator__nbOfFollowers">{{ follow_count }} {% trans "followers" %}</p> {# TODO - make "number of followers" dynamic #}
                </div>
            </div>
        </div>
    </div>
{% endblock before_layout %}

{% block column_left %}
    <div class="grid__sidebarWidget">
        {# TODO : dynamic tags #}
        <ul>
            <li class="tag">Bohemian</li>
            <li class="tag">Contemporary</li>
            <li class="tag">Streetstyle</li>
            <li class="tag">Vintage</li>
        </ul>
        <div class="creator__bio">
            {{ influencer.bio }}
        </div>
    </div>

    <div class="grid__sidebarWidget">
        {% include "partials/share_menu.html" %}
    </div>
{% endblock column_left %}

{% block grid_header_sortBy %}
    {% include "partials/grid_sort_by.html" %}
{% endblock %}

{% block grid_header_results %}
    {# TODO - make number of results work #}
    {% include "partials/number_of_results.html" %}
{% endblock %}

{% block content_classnames %}color-context color-context--creator{% endblock %}

{% block content %}
    {% if products %}
        {% include "catalogue/partials/products_gridList.html" %}
    {% else %}
        <div class="grid__emptyMessage">
            <p class="missing">{% trans "No products for now." %}</p>
        </div>
    {% endif %}
{% endblock content %}

{% block after_layout %}
    <div class="u-desktop-only">
      {% trans "More crea tors" as triptych_title %}
      {% include "influencers/partials/influencers_triptych.html" with triptych_title=triptych_title triptych_isBigTitle=True triptych_isWrapperThinner=True %}
    </div>
{% endblock after_layout %}


{% block extrascripts %}
    {{ block.super }}
    <script>

      function getFollowData(ucc_id) {
      $.ajax({
        url: "/accounts/follow-unfollow-ucc/" + ucc_id,

        success: function (data) {
            // TODO the message to be shown is also sent in the response data
            if (data['followed'] == true){
                $( "#follow_button" ).text( 'Unfollow creator' );
            }
            else{
                $( "#follow_button" ).text( 'Follow creator' );
            }
            $( "#follow_count" ).text( data['follow_count'] );
        }
      });
    }

    </script>


{% endblock %}